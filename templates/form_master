


<metal:block metal:define-macro="text_display_widget">
<tr>
  <td><strong tal:content="slot_pretty_name">slot_pretty_name</strong></td>
  <td>
  <tal:block condition="exists:slot_value" replace="slot_value">
  </tal:block>
  <tal:block condition="not:exists:slot_value">&nbsp;</tal:block>
  </td>
</tr>
</metal:block>



<metal:block metal:define-macro="text_widget">
<tr>
  <td><strong tal:content="slot_pretty_name">slot_pretty_name</strong></td>
  <td>
  <tal:block condition="exists:slot_value">
    <input 
       type="text" 
       name="" 
       value=""
       tal:attributes="name field_name;
                       value slot_value" 
       size="31"/>
  </tal:block>
  <tal:block condition="not:exists:slot_value">
    <input 
       type="text" 
       name="" 
       tal:attributes="name field_name" 
       size="31"/>
  </tal:block>

  </td>
</tr>
</metal:block>





auto_widget expects the following arguments:
  slot_name
  field_name
  slot_pretty_name
  slot_values

<metal:block metal:define-macro="auto_widget">

<tal:block 
  define="svt python:get_slot_values(slot_name,
                                     ':SLOT-VALUE-TYPE')[0];
          slot_value_type python:svt and str(svt[0]) or ':INTEGER';">

  <tr>
    <td valign="top">
       <strong tal:content="slot_pretty_name">slot_pretty_name</strong>
       <br/>
       <em tal:content="slot_value_type"></em>
    </td>
    <td>


  <tal:block condition="python:slot_value_type == ':STRING'"
             define="text_value python:slot_values and str(slot_values[0]) or '';
                     len_text_value python:len(text_value)">

     <textarea
          name=""
          cols="60"
          rows="5"
          tal:condition="python:len_text_value > textarea_threshold"
          tal:attributes="name field_name"
          tal:content="text_value"></textarea>


     <input type="text"
         tal:condition="python:len_text_value <= textarea_threshold"
         name="" value="" size=""         
         tal:attributes="name field_name;
                         size python:slot_value_type == ':STRING' and 31 or 10;
                         value text_value"/>
  </tal:block>


  <tal:block condition="python:slot_value_type == ':INTEGER'">
  <input type="text" 
         name="" value="" size="10"
         tal:attributes="name field_name;
                         value python:slot_values and slot_values[0] or ''"/>
  </tal:block>

  <tal:block condition="python:slot_value_type != None and
                               not (slot_value_type in [':INTEGER',
                                                        ':STRING'])">
    <tal:dummy 
      define="slot_cardinality python:get_slot_value(slot_name,
                                                     ':SLOT-CARDINALITY')[0];
              slot_collection_type python:get_slot_value(slot_name,
                                                     ':SLOT-COLLECTION-TYPE')[0];
              select_size python:slot_cardinality != None and 
                                   slot_cardinality > 1 and 5
                                 or slot_collection_type != None and 5
                                 or 1;
              options python:get_class_instances(slot_value_type)[0];
              multiple python:(slot_cardinality != None and 
                               slot_cardinality > 1 and 'multiple') or 
                              (slot_collection_type and 'multiple') or '';
              size python:len(options) > select_size and select_size
                                   or len(options)">


    <tal:dummy 
        replace="structure string:<select name=&quot;$field_name&quot; $multiple size=&quot;$size&quot;>"/>

      <tal:block 
         repeat="opt options">
         <tal:block
           define="selected python:str(opt) in slot_values and ' SELECTED' or ''">
           <tal:dummy replace="structure string:<option$selected>$opt</option>"/>
         </tal:block>
      </tal:block>

    <tal:dummy replace="structure string:</select>"/>
    <br/>
    --<tal:dummy replace="slot_values"/>--
    </tal:dummy>
  </tal:block>


    </td>
  </tr>
</tal:block>

</metal:block>














$Id: form_master,v 1.6 2003/03/08 13:07:11 smurp Exp $ <a href="/templates/form_master">Show Source</a>
